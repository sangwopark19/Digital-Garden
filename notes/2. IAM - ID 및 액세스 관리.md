## 1. IAM 소개: 사용자, 그룹, 정책
---
#### 1. **IAM 개요**

- IAM은 **Identity and Access Management**의 약자.
- AWS 계정에서 **사용자와 그룹을 생성**하고, **권한을 관리**할 수 있음.
- **글로벌 서비스**: 리전 구분 없이 사용 가능.

---

#### 2. **IAM의 핵심 개념**

1. **루트 사용자**:
    
    - AWS 계정을 생성할 때 기본 생성.
    - **최소 사용 원칙**: 계정 생성 이후 루트 사용자는 더 이상 사용하거나 공유하지 않음.
2. **사용자(User)**:
    
    - **조직 내 개인**을 나타냄.
    - 특정 작업을 수행할 권한 부여 가능.
3. **그룹(Group)**:
    
    - **사용자들의 모임**으로, 동일한 권한을 공유하도록 구성.
    - 그룹에는 **다른 그룹을 포함할 수 없음**.
    - 한 사용자는 **여러 그룹에 속할 수 있음**.
4. **IAM 정책 (IAM Policies)**:
    
    - **JSON 문서** 형식으로 권한을 정의.
    - 사용자가 **특정 작업 및 서비스에 접근**하도록 허용하거나 거부.
    - 예: EC2 사용, Describe 작업, CloudWatch 접근 등.
    - **최소 권한 원칙** 적용:
        - 꼭 필요한 권한만 부여하여 비용 및 보안 문제 방지.

---

#### 3. **IAM 사용 예시**

- **사용자 및 그룹 예제**:
    
    - Alice, Bob, Charles → `Developers` 그룹.
    - David, Edward → `Operations` 그룹.
    - Fred → **그룹 미속성 사용자** (비추천).
- **다중 그룹**:
    
    - Charles와 David은 `Developers`와 `Audit` 그룹에 모두 속할 수 있음.
- **정책 예시 (JSON)**:
    
    ```json
    {
        "Version": "2012-10-17",
        "Statement": [
            {
                "Effect": "Allow",
                "Action": [
                    "ec2:Describe*",
                    "elasticloadbalancing:Describe*",
                    "cloudwatch:Describe*"
                ],
                "Resource": "*"
            }
        ]
    }
    ```
    

---

#### 4. **IAM의 원칙**

- **최소 권한 원칙**:
    - 사용자에게 꼭 필요한 권한만 부여.
    - 불필요한 서비스 실행 및 보안 사고 방지.


## 2. IAM 사용자 및 그룹 실습
---
#### 1. **IAM 사용자 생성 과정**

1. **IAM 콘솔 접속**:
    
    - AWS 검색창에서 "IAM" 검색 후 대시보드로 이동.
    - **IAM은 글로벌 서비스**로, 리전 선택이 필요 없음.
2. **새 사용자 생성**:
    
    - IAM 대시보드 → **Users** → **Add user** 클릭.
    - 사용자 이름 입력(예: Stephane).
    - **AWS Management Console 접근 허용**:
        - 비밀번호 설정 (자동 생성 또는 사용자 정의 선택 가능).
        - "사용자가 다음 로그인 시 비밀번호 변경" 옵션 설정 여부 선택.
3. **그룹 생성 및 권한 부여**:
    
    - 새 그룹 생성(예: `admin`).
    - 권한 정책 추가(예: `Administrator Access`).
    - 사용자를 생성된 그룹에 추가.
4. **태그 추가 (선택 사항)**:
    
    - 예: `Key: Department`, `Value: Tech`.
5. **설정 검토 후 사용자 생성**:
    
    - 생성 완료 후 로그인 정보를 다운로드(CSV) 또는 복사.

---

#### 2. **IAM 사용자 로그인**

1. **로그인 URL 생성**:
    
    - **로그인 별칭 생성**(예: `aws-stephane-v5`)으로 URL 간소화.
    - 로그인 URL: `https://aws-account-alias.signin.aws.amazon.com/console`.
2. **로그인 방법**:
    
    - **IAM 사용자 로그인 페이지**에서 별칭 또는 계정 ID 입력.
    - 사용자 이름 및 비밀번호 입력 후 로그인.
3. **브라우저 활용 팁**:
    
    - 루트 계정과 IAM 사용자 계정을 동시에 사용하려면 **시크릿 모드** 활용.

---

#### 3. **루트 사용자와 IAM 사용자 비교**

1. **루트 사용자**:
    
    - 계정 생성 시 기본 생성.
    - **최소 사용 권장**: 계정 설정과 같은 특정 작업에만 사용.
2. **IAM 사용자**:
    
    - 일반적인 AWS 사용 및 관리를 위해 생성.
    - 그룹 및 정책을 통해 권한 관리.
    - **보안 강화**: 루트 계정 사용 대신 IAM 사용자 사용 권장.

---

#### 4. **IAM 사용 권장 사항**

- 루트 계정은 계정 관리 작업(예: 결제 정보 수정)에만 사용.
- 일반 작업 및 서비스 관리는 IAM 사용자를 통해 수행.
- IAM 사용자를 그룹에 추가하여 권한을 일괄 관리.
- **최소 권한 원칙** 적용:
    - 필요 이상의 권한을 부여하지 않음.


## 3. IAM 정책
---
#### 1. **IAM 정책 적용 시나리오**

1. **그룹 레벨 정책 적용**:
    
    - **개발자 그룹**: Alice, Bob, Charles.
        - 그룹에 연결된 정책은 모든 구성원(Alice, Bob, Charles)에게 **상속**.
    - **운영자 그룹**: David, Edward.
        - 운영자 그룹에는 개발자 그룹과 **다른 정책** 적용.
2. **인라인 정책**:
    
    - **Fred**와 같이 그룹에 속하지 않은 사용자에게 직접 정책 연결 가능.
    - **특정 사용자에 대한 맞춤형 권한 제공**.
3. **다중 그룹 정책 적용**:
    
    - Charles와 David가 감사팀에도 속할 경우:
        - Charles는 개발자 그룹 + 감사팀 정책 상속.
        - David는 운영자 그룹 + 감사팀 정책 상속.

---

#### 2. **IAM 정책 구조**

IAM 정책은 **JSON 문서** 형식으로 작성되며, 주요 구성 요소는 다음과 같습니다:

1. **Version**:
    
    - 정책 언어 버전을 정의.
    - 일반적으로 `2012-10-17` 사용.
2. **Statement**:
    
    - 정책의 핵심 구성 요소.
    - 여러 개의 문장(Statement)을 포함 가능.
3. **Statement의 필수 요소**:
    
    - **Sid** (Statement ID):
        - 문장을 식별하는 선택적 ID.
    - **Effect**:
        - API 접근 허용(`Allow`) 또는 거부(`Deny`) 여부.
    - **Principal**:
        - 정책이 적용되는 사용자, 계정, 역할.
    - **Action**:
        - 허용 또는 거부되는 **API 호출** 목록.
        - 예: `s3:PutObject`, `ec2:StartInstances`.
    - **Resource**:
        - 정책이 적용되는 AWS 리소스 목록.
        - 예: 특정 S3 버킷(`arn:aws:s3:::example-bucket`).
    - **Condition** (선택 사항):
        - 특정 조건에서만 정책이 적용되도록 제한.

---

#### 3. **IAM 정책 예시 (JSON)**

```json
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "1",
            "Effect": "Allow",
            "Principal": {
                "AWS": "arn:aws:iam::123456789012:root"
            },
            "Action": [
                "s3:PutObject",
                "s3:GetObject"
            ],
            "Resource": "arn:aws:s3:::example-bucket/*"
        }
    ]
}
```

**구성 요소 설명**:

- **Version**: 정책의 버전.
- **Sid**: "1"로 문장을 식별.
- **Effect**: `Allow`로 S3 작업 허용.
- **Principal**: AWS 계정의 루트 계정(`123456789012`).
- **Action**: `s3:PutObject` 및 `s3:GetObject` 작업 허용.
- **Resource**: S3 버킷 `example-bucket`의 모든 객체.

---

#### 4. **정책 작성 및 시험 대비 포인트**

- **Effect**: 허용 또는 거부의 목적을 결정.
- **Principal**: 정책 대상 지정.
- **Action**: 허용/거부되는 작업 목록.
- **Resource**: 특정 리소스에 대한 정책 적용.
- **Condition**: 특정 조건에서만 정책 적용(시험에 자주 출제).


## 4. IAM 정책 실습
---

## EC2 전체 요약
---
#### 1. **EC2 인스턴스 생성**

- **AMI (Amazon Machine Image)**:
    - EC2 인스턴스의 운영 체제를 정의.
- **인스턴스 크기**:
    - CPU 성능과 RAM 크기를 기반으로 선택.
- **스토리지 옵션**:
    - EC2 인스턴스의 데이터 저장소를 설정.

---

#### 2. **보안 그룹**

- **외부 방화벽 역할**:
    - EC2 인스턴스에 연결되며 트래픽을 제어.
- **규칙 정의**:
    - 액세스 가능한 **포트**(예: 22번 포트 for SSH)와 **IP 주소** 설정.

---

#### 3. **EC2 사용자 데이터**

- **부트스트랩 스크립트**:
    - 인스턴스 시작 시 자동으로 실행되는 스크립트.
    - 예: 웹 서버 설정 및 "Hello, world" 출력.

---

#### 4. **SSH 연결**

- **터미널을 통한 원격 제어**:
    - 포트 22를 사용하여 EC2 인스턴스에 명령 실행 가능.

---

#### 5. **IAM 역할과 EC2 역할**

- **IAM 역할**:
    - EC2 인스턴스에 권한을 제공하여 AWS 리소스와 상호작용 가능.
- **EC2 인스턴스 역할**:
    - 인스턴스가 IAM 정책에 따라 AWS 명령 실행 가능.

---

#### 6. **구매 옵션**

- **주문형 (On-Demand)**:
    - 사용한 만큼 비용을 지불.
- **스팟 인스턴스 (Spot Instances)**:
    - 남는 용량을 저렴하게 활용, 언제든 종료 가능.
- **예약 인스턴스 (Reserved Instances)**:
    - 1년 또는 3년 동안 인스턴스 예약으로 비용 절감.
    - **전환형 예약 인스턴스**: 유연한 변경 가능.
- **전용 호스트 (Dedicated Host)**:
    - 물리적 서버 예약.
- **전용 인스턴스 (Dedicated Instance)**:
    - 전용 하드웨어에서 실행.

---

#### 7. **핵심 요약**

- EC2는 사용자가 필요한 대로 **운영 체제, 크기, 스토리지**를 설정할 수 있는 클라우드 컴퓨팅 서비스.
- **보안 그룹과 IAM 역할**은 보안 및 AWS 리소스 접근을 관리.
- 다양한 **구매 옵션**으로 워크로드와 예산에 맞춘 인스턴스 선택 가능.

---

#### 8. **시험 대비 포인트**

- EC2의 핵심 구성 요소 (AMI, 인스턴스 크기, 보안 그룹, 사용자 데이터).
- SSH와 IAM 역할의 기능 및 중요성.
- 각 구매 옵션의 특징과 적합한 워크로드.

---

#### 9. **결론**

- EC2는 AWS의 핵심 서비스로, 강력한 유연성과 확장성을 제공.
- 보안과 비용 효율성을 고려하여 적합한 옵션을 선택해야 함.

---


## 1. AWS 예산 설정
---
#### 1. **IAM 사용자 결제 데이터 접근 활성화**

1. **루트 계정으로 로그인**:
    
    - **IAM 사용자**는 기본적으로 결제 데이터에 접근할 수 없음.
    - 루트 계정으로 **결제 데이터 IAM 액세스 활성화** 필요.
2. **결제 IAM 액세스 활성화 방법**:
    
    - **Account Settings** → **IAM Access to Billing Information** → **Activate IAM Access**.

---

#### 2. **결제 콘솔 탐색**

1. **Billing Overview**:
    
    - 현재 월 및 예상 월간 비용 확인.
    - 지난 달 및 이전 달 비용 확인.
2. **청구서(Bills)**:
    
    - 서비스별 비용 내역 제공.
    - 특정 서비스(예: EC2)의 사용량 및 청구 내역 분석 가능.
    - **월별 청구서** 선택 후 하단에서 **서비스별 요금(Charges by Service)** 확인.
3. **프리 티어(Free Tier)**:
    
    - 현재 사용량과 **프리 티어 한도** 비교.
    - 초과 시 빨간색 경고 표시.

---

#### 3. **예산 설정 및 알림**

1. **예산 생성 위치**:
    
    - **Billing Console** → **Budgets** → **Create Budget**.
2. **예산 생성 과정**:
    
    - **지출 없는 예산**:
        
        - 예산 이름: "No Spending Budget".
        - 목표: **0.01달러** 도달 시 알림.
            - 알림 수신 이메일 입력.
    - **월간 비용 예산**:
        
        - 예산 이름: "Monthly Budget".
        - 목표: **10달러** 도달 시 알림.
        - 알림 조건:
            - **85% 도달** 시 알림.
            - **100% 도달** 시 알림.
            - **예상 지출이 100%에 도달 예상** 시 알림.
3. **알림 수신 내용**:
    
    - 실시간으로 **예산 초과 상황** 이메일 수신.

---

#### 4. **예산 설정 모범 사례**

- **지출 없는 예산** 설정:
    
    - 0.01달러 초과 시 즉시 알림.
    - 사용하지 않을 리소스를 빠르게 식별 및 제거.
- **월간 예산 설정**:
    
    - 현실적인 예산(예: 10달러)으로 비용 초과 방지.
    - 예산 초과 예상 시 조기 알림으로 대응 가능.
- **프리 티어 모니터링**:
    
    - 무료로 제공되는 리소스 사용량을 지속적으로 확인.
    - 초과 사용으로 인한 불필요한 비용 방지.

---

#### 5. **AWS 비용 문제 해결**

1. **청구서**:
    
    - 서비스별 사용 내역 분석.
    - 불필요한 서비스 식별 후 사용 중지.
2. **프리 티어 대시보드**:
    
    - 무료 한도 초과 여부 실시간 확인.
3. **예산 알림**:
    
    - 초과 지출 가능성을 조기에 식별하여 비용 관리.

---

#### 6. **핵심 요약**

- **IAM 사용자 결제 데이터 접근 활성화**로 관리 효율성 증대.
- **예산 및 알림 설정**으로 과도한 비용 발생 방지.
- **청구서 및 프리 티어 사용량 분석**으로 비용 투명성 확보.

---

## 2. EC2 기초
---
#### 1. **Amazon EC2란?**

- **Elastic Compute Cloud**의 약자.
- AWS의 가장 인기 있는 서비스로, **서비스형 인프라(IaaS)** 제공.
- **주요 기능**:
    - 가상 머신(EC2 인스턴스) 임대.
    - 데이터 저장(EBS, EFS).
    - 부하 분산(Elastic Load Balancer).
    - 자동 확장(Auto Scaling Group).

---

#### 2. **EC2의 주요 구성 요소**

1. **운영 체제 선택**:
    
    - 리눅스(가장 인기 있음), 윈도우, 맥OS.
2. **컴퓨팅 리소스**:
    
    - vCPU(가상 CPU) 및 RAM 크기 선택.
    - 스토리지 유형: EBS, EFS, EC2 인스턴스 스토어.
3. **네트워크 설정**:
    
    - 공용 IP, 네트워크 속도 및 카드 설정.
4. **보안 그룹**:
    
    - **방화벽 규칙** 정의.
    - EC2 인스턴스와 외부 트래픽 간 허용/차단 규칙 설정.
5. **사용자 데이터 스크립트**:
    
    - **부트스트래핑**을 위한 초기화 스크립트 실행.
    - 업데이트, 소프트웨어 설치, 파일 다운로드 등 자동화 가능.

---

#### 3. **사용자 데이터 스크립트 (User Data Script)**

- **의미**:
    - 인스턴스 부팅 시 실행되는 초기화 스크립트.
    - 부팅 시 1회 실행 후 종료.
- **사용 사례**:
    - 시스템 업데이트.
    - 필요한 소프트웨어 설치.
    - 웹사이트 배포 및 설정.
- **특징**:
    - 루트 계정으로 실행되며, `sudo` 명령어 필요.

---

#### 4. **EC2 인스턴스 종류**

|인스턴스 종류|vCPU|메모리|스토리지|네트워크 성능|
|---|---|---|---|---|
|**t2.micro**|1|1GB|EBS 전용|낮음 ~ 중간|
|**t2.xlarge**|4|16GB|EBS 전용|중간|
|**c5d.4xlarge**|16|32GB|NVMe SSD(400GB)|최대 10Gbps|
|**r5.16xlarge**|64|512GB|EBS 전용|고성능|
|**m5.8xlarge**|32|128GB|EBS 전용|고성능|

---

#### 5. **t2.micro 인스턴스 (프리 티어)**

- **특징**:
    - AWS 프리 티어에 포함.
    - 한 달에 750시간 사용 가능(1년 동안 무료).
- **사용 사례**:
    - 강의 실습 및 테스트 환경.

---

#### 6. **EC2의 강점**

- **유연성**: 요구에 맞는 가상 머신 선택 가능.
- **확장성**: 필요에 따라 자원을 추가하거나 축소 가능.
- **자동화**: 사용자 데이터 스크립트를 활용한 초기 작업 자동화.

---

## 3. 웹 사이트 실습을 위한 EC2 사용자 데이터로 EC2 인스턴스 생성
---
#### **1. EC2 인스턴스 실행 과정**

1. **AWS 콘솔에서 EC2 인스턴스 실행**:
    - EC2 콘솔 접속 → **Instances** 클릭 → **Launch instances** 클릭.
2. **인스턴스 이름 추가**:
    - "My First Instance" 입력.
3. **운영 체제 선택**:
    - Quick Start에서 **Amazon Linux 2 AMI** 선택.
4. **인스턴스 유형 설정**:
    - **t2.micro** 선택 (프리 티어 무료 제공, 한 달 750시간 가능).
5. **키 쌍 생성 및 다운로드**:
    - 키 쌍 이름: **EC2 Tutorial**.
    - 키 형식:
        - **.pem**: Mac/Linux/Windows 10 이상.
        - **.ppk**: Windows 7/8.
6. **네트워크 설정**:
    - 보안 그룹 설정:
        - **SSH(포트 22)** 및 **HTTP(포트 80)** 허용.
7. **스토리지 구성**:
    - 기본 설정 유지 (8GiB, EBS SSD).
8. **사용자 데이터 추가**:
    - EC2 인스턴스 실행 시 자동으로 웹 서버 및 기본 HTML 파일 설정.

```bash
#!/bin/bash
yum update -y
yum install -y httpd
systemctl start httpd
systemctl enable httpd
echo "Hello World from $(hostname -I)" > /var/www/html/index.html
```

9. **인스턴스 시작**:
    - "Launch Instance" 클릭 → "View All Instances"에서 상태 확인.

---

#### **2. 웹 서버 확인**

1. **퍼블릭 IP 주소로 웹 서버 확인**:
    - **퍼블릭 IPv4 주소** 복사 → `http://<퍼블릭 IP>` 접속.
    - 페이지에 "Hello World from [프라이빗 IP]" 표시.
2. **주의**:
    - 반드시 **http://**로 접속.
    - 처음 실행 시 약간의 대기 시간 필요.

---

#### **3. EC2 인스턴스 관리**

1. **멈추기 (Stop)**:
    - **Instance state → Stop instance** 선택.
    - 퍼블릭 IP는 삭제되지만, EBS 스토리지는 유지.
    - 비용 청구 중지.
2. **다시 시작 (Start)**:
    - **Instance state → Start instance** 선택.
    - 새 퍼블릭 IP 할당 (이전과 다를 수 있음).
3. **제거 (Terminate)**:
    - **Instance state → Terminate instance**.
    - 인스턴스와 연결된 스토리지 삭제.

---

#### **4. 실습에서의 주요 포인트**

1. **퍼블릭 IP의 변화**:
    - 인스턴스가 멈췄다가 시작되면 퍼블릭 IP가 변경됨.
    - 프라이빗 IP는 변경되지 않음.
2. **프리 티어 활용**:
    - t2.micro로 한 달 750시간 무료 이용 가능.
3. **웹 서버 상태**:
    - 사용자 데이터 스크립트로 초기화된 상태로 유지.

---

## 4. EC2 인스턴스 유형 기본 사항
---
#### **1. 인스턴스 이름 규칙**

AWS 인스턴스 이름은 특정 의미를 내포합니다.

- **예시:** `m5.2xlarge`
    - **`m` (클래스):** 범용 인스턴스.
    - **`5` (세대):** 5세대 하드웨어.
    - **`2xlarge` (크기):** 2배 크기의 대형 인스턴스. 크기에 따라 메모리와 CPU가 증가.

---

#### **2. 주요 인스턴스 유형**

1. **범용 (General Purpose)**
    
    - **특징:** 컴퓨팅, 메모리, 네트워킹의 균형.
    - **사용 사례:** 웹 서버, 코드 저장소, 소규모 데이터베이스.
    - **예시:** `t2.micro`, `m5.large`.
    - **강의 사용:** **`t2.micro`** (프리 티어 제공).
2. **컴퓨팅 최적화 (Compute Optimized)**
    
    - **특징:** 높은 컴퓨팅 성능 제공.
    - **사용 사례:** HPC(고성능 컴퓨팅), 머신 러닝, 게임 서버.
    - **예시:** `c5.large`, `c6g.xlarge`.
3. **메모리 최적화 (Memory Optimized)**
    
    - **특징:** RAM(메모리) 집중적 작업에 적합.
    - **사용 사례:** 대규모 데이터베이스, 실시간 처리.
    - **예시:** `r5.large`, `x1e.xlarge`.
4. **스토리지 최적화 (Storage Optimized)**
    
    - **특징:** 대규모 로컬 데이터 처리에 최적화.
    - **사용 사례:** 데이터 웨어하우징, 분산 파일 시스템.
    - **예시:** `i3.large`, `h1.4xlarge`.

---

#### **3. 인스턴스 비교 예시**

|**인스턴스 이름**|**vCPU**|**메모리 (GB)**|**네트워크 성능**|**특징**|
|---|---|---|---|---|
|`t2.micro`|1|1|낮음~중간|프리 티어 제공.|
|`r5.16xlarge`|64|512|높음|메모리 최적화.|
|`c5d.4xlarge`|16|32|최대 10Gbps|컴퓨팅 최적화.|

---

#### **4. 인스턴스 유형과 요금 비교 사이트**

- **사이트:** [instances.vantage.sh](https://instances.vantage.sh/)
    - AWS의 모든 EC2 인스턴스 정보를 검색 및 비교 가능.
    - 요금, 메모리, vCPU, 네트워크 성능 등의 상세 정보 제공.
    - AWS 사용자에게 유용한 도구.

---

#### **5. AWS 프리 티어와 t2.micro**

- **프리 티어 제공 인스턴스:** `t2.micro`.
- **제공 시간:** 한 달에 최대 **750시간**.
- **특징:** 소규모 애플리케이션 및 실습에 적합.

---


## 5. 보안 그룹 및 클래식 포트 개요
---
### **AWS EC2 보안 그룹 개요**

AWS 보안 그룹은 EC2 인스턴스 주변의 방화벽 역할을 하며, 네트워크 트래픽의 인바운드(들어오는 트래픽)와 아웃바운드(나가는 트래픽)를 제어합니다. 다음은 보안 그룹의 주요 개념과 사용법을 요약한 내용입니다.

---

#### **1. 보안 그룹의 특징**

1. **기능:**
    
    - **허용 규칙만 포함:** 허용된 트래픽만 EC2 인스턴스에 도달 가능.
    - **IP 주소 또는 보안 그룹 참조:** 특정 IP 범위 또는 다른 보안 그룹을 기준으로 설정.
    - **기본 설정:** 모든 인바운드 트래픽은 차단되고, 모든 아웃바운드 트래픽은 허용.
2. **다중 연결:**
    
    - 하나의 보안 그룹이 여러 인스턴스에 연결 가능.
    - 하나의 인스턴스가 여러 보안 그룹을 가질 수도 있음.
3. **위치 제한:**
    
    - 특정 **리전**과 **VPC**에만 적용.
    - 다른 리전이나 VPC로 전환 시 새로운 보안 그룹 생성 필요.
4. **EC2 외부에서 작동:**
    
    - EC2 인스턴스 외부에 위치하며 트래픽을 EC2에 도달하기 전에 차단.

---

#### **2. 보안 그룹 규칙**

1. **인바운드 규칙:**
    
    - EC2 인스턴스로 들어오는 트래픽을 제어.
    - 프로토콜(TCP/UDP), 포트 번호, 소스(IP 범위)로 정의.
2. **아웃바운드 규칙:**
    
    - EC2 인스턴스에서 나가는 트래픽을 제어.
    - 기본적으로 모든 트래픽 허용.
3. **규칙 예시:**
    
    - **소스 IP 범위:** `0.0.0.0/0` (모든 IP 허용), `203.0.113.0/24` (특정 서브넷 허용).
    - **특정 포트:** 22번(SSH), 80번(HTTP), 443번(HTTPS).

---

#### **3. 포트 번호 요약**

- **22번 (SSH):** 리눅스 인스턴스에 로그인.
- **21번 (FTP):** 파일 전송.
- **22번 (SFTP):** 안전한 파일 전송(SSH 사용).
- **80번 (HTTP):** 보안되지 않은 웹 트래픽.
- **443번 (HTTPS):** 보안 웹 트래픽.
- **3389번 (RDP):** 윈도우 인스턴스에 원격 로그인.

---

#### **4. 고급 보안 그룹 기능**

1. **다른 보안 그룹 참조:**
    
    - 특정 보안 그룹에서 다른 보안 그룹을 참조해 규칙 생성.
    - 예: 로드 밸런서와 EC2 간 통신을 허용하기 위해 보안 그룹 간 연결 설정.
2. **보안 그룹 문제 해결:**
    
    - **타임아웃:** 인바운드 규칙이 제대로 설정되지 않음.
    - **연결 거부:** 애플리케이션이 실행 중이지 않거나 오류 발생.
3. **최고의 실무:**
    
    - SSH 액세스를 위해 별도의 보안 그룹 생성 권장.
    - 필수적인 규칙만 추가하여 최소 권한의 원칙 적용.

---

#### **5. 다이어그램 예시**

- **보안 그룹과 트래픽 흐름:**
    
    - 인바운드 규칙: EC2 인스턴스로 들어오는 트래픽 제어.
    - 아웃바운드 규칙: EC2 인스턴스에서 나가는 트래픽 제어.
- **보안 그룹 간 참조:**
    
    - 보안 그룹 1 ↔ 보안 그룹 2: 서로 통신 허용.
    - 보안 그룹 3: 통신 차단.

---


## 6. 보안 그룹 실습
---
#### 1. **보안 그룹 개요**

- **Security Groups**는 EC2 인스턴스의 네트워크 트래픽을 제어하는 방화벽 역할을 합니다.
- 보안 그룹은 **인바운드(Inbound)**와 **아웃바운드(Outbound)** 규칙을 포함합니다.
- **인바운드 규칙**: 외부에서 인스턴스로 들어오는 연결을 제어.
- **아웃바운드 규칙**: 인스턴스에서 외부로 나가는 연결을 제어.

---

#### 2. **보안 그룹 탐색**

- **EC2 콘솔**의 사이드 메뉴에서 `Network & Security > Security Groups`를 클릭해 확인.
- 기본적으로 두 가지 보안 그룹이 존재:
    1. 기본 보안 그룹 (자동 생성)
    2. **launch-wizard-1**: 인스턴스 생성 시 자동으로 만들어짐.

---

#### 3. **보안 그룹의 주요 속성**

- 보안 그룹마다 고유 **ID**가 있으며, 이는 EC2 인스턴스를 식별하는 역할을 함.

---

#### 4. **인바운드 규칙**

- 외부에서 인스턴스로 연결을 허용하는 설정.
- 예시:
    - **SSH (22번 포트)**: 모든 위치(0.0.0.0/0)에서 접근 가능.
    - **HTTP (80번 포트)**: 모든 위치에서 웹 서버에 연결 허용.
- 규칙 편집 시:
    - 모든 위치(CIDR: `0.0.0.0/0`)로 설정하거나 특정 IP만 허용 가능 (`My IP`).
    - 특정 프로토콜(예: HTTPS)을 선택하면 포트가 자동 설정됨.

---

#### 5. **규칙 테스트 및 문제 해결**

- 규칙 삭제 후 테스트:
    - HTTP 규칙 삭제 시, 웹 페이지 접속 불가.
    - 규칙 복구 후 새로 고침 시 정상 작동.
- **시간초과(Time-out)** 발생 원인:
    - 보안 그룹 규칙이 올바르게 설정되지 않았을 가능성 높음.
    - 필요한 규칙을 추가하면 문제 해결 가능.

---

#### 6. **아웃바운드 규칙**

- 기본적으로 **IPv4 모든 위치**로 트래픽이 허용됨.
- EC2 인스턴스가 인터넷에 접근 가능하도록 설정.

---

#### 7. **보안 그룹의 확장성**

- 한 인스턴스에 여러 보안 그룹 연결 가능.
- 하나의 보안 그룹을 여러 인스턴스에 연결 가능.
- 각 보안 그룹에 개별 규칙을 설정할 수 있음.

---

#### 8. **추가 설정 가능 요소**

- **CIDR Blocks**, **Security Groups**, **Prefix Lists**를 사용해 세부적으로 규칙 설정 가능.
- **My IP**로 설정 시, IP 변경 시 주의 필요.

---

## 7. 리눅스 / 맥을 사용하여 SSH 실행하는 방법
---
### SSH를 통한 EC2 인스턴스 연결 요약

#### 1. **SSH란?**

- **SSH(Secure Shell)**는 터미널이나 명령줄을 통해 원격 서버를 제어하는 방법.
- Amazon Cloud에서 중요한 기능으로, EC2 인스턴스에 안전하게 접속 가능.

---

#### 2. **SSH 연결 전 준비**

1. **키 파일 준비**:
    - EC2 인스턴스 생성 시 다운로드한 `.pem` 파일 사용.
    - 파일명에 공백이 없어야 하며, 원하는 디렉터리로 이동.
2. **퍼블릭 IPv4 주소 확인**:
    - EC2 콘솔에서 **퍼블릭 IPv4 주소** 복사.
3. **보안 그룹 확인**:
    - 22번 포트(SSH)가 **모든 위치(0.0.0.0/0)**에서 접근 가능하도록 설정 확인.
    - 규칙이 없다면 보안 그룹에서 추가.

---

#### 3. **SSH 연결 명령어**

1. 기본 명령 형식:
    
    ```bash
    ssh -i <키 파일 경로> ec2-user@<퍼블릭 IP>
    ```
    
2. **디렉터리 확인**:
    - 현재 위치 확인: `pwd`
    - 파일 확인: `ls`
    - 올바른 디렉터리로 이동: `cd <디렉터리>`
3. **권한 설정**:
    - 키 파일 권한 변경:
        
        ```bash
        chmod 0400 <키 파일>
        ```
        

---

#### 4. **SSH 연결 과정**

1. 터미널에 아래 명령 입력:
    
    ```bash
    ssh -i EC2Tutorial.pem ec2-user@<퍼블릭 IP>
    ```
    
2. 프롬프트에 `yes` 입력 후 연결 성공 확인.

---

#### 5. **연결 후 작업**

- **명령어 실행**:
    - 현재 사용자 확인: `whoami` → 결과: `ec2-user`
    - 네트워크 테스트: `ping google.com`
- **명령 중단**: `Ctrl+C`
- **연결 종료**:
    - 명령: `exit` 또는 `Ctrl+D`

---

#### 6. **주의사항**

1. **퍼블릭 IP 변경**:
    - 인스턴스를 중단 후 다시 시작하면 퍼블릭 IP가 변경됨.
    - 새 IP를 확인하고 명령어 수정 필요.
2. **올바른 디렉터리**:
    - `.pem` 파일이 있는 디렉터리에서 명령 실행.
3. **파일 권한**:
    - `.pem` 파일의 권한이 올바르게 설정되지 않으면 오류 발생.

---

#### 7. **명령어 요약**

- 디렉터리 이동: `cd`
- 현재 위치 확인: `pwd`
- 파일 리스트 확인: `ls`
- 권한 설정: `chmod 0400 <키 파일>`
- SSH 연결:
    
    ```bash
    ssh -i <키 파일> ec2-user@<퍼블릭 IP>
    ```
    
- 연결 종료: `exit` 또는 `Ctrl+D`

---

## 8. SSH 문제 해결
---

> **1) 연결 타임아웃 이슈가 있습니다.**

이 부분은 보안 그룹 문제입니다. 모든 타임아웃 (SSH 뿐만 아니라)은 보안 그룹 또는 방화벽과 관련된 문제 입니다. 보안 그룹이 다음과 같이 표시되고 EC2 인스턴스에 올바르게 할당되었는지 확인하세요.

![](https://img-c.udemycdn.com/redactor/raw/2019-10-23_14-53-48-cc1a033599952b0c25e1932ddfe1eb46.png)

> **2) 여전히 연결 타임아웃 이슈가 있습니다.**

보안 그룹이 위와 같이 올바르게 구성되어 있음에도 불구하고 지속적으로 연결 타임아웃 이슈가 발생한다면 회사 방화벽이나 개인 방화벽이 연결을 차단하고 있음을 의미합니다. **다음 강의에서 설명하는 대로 EC2 Instance Connect를 사용하시기 바랍니다.**

  

> **3) SSH윈도우에서 작동하지 않습니다.**

- 다음과 같이 표시되는 경우: `ssh command not found`, 즉 Putty를 사용해야 함을 의미합니다.
    
- 다시 영상을 따라해보세요. 작동하지 않으면 다음 강의에 설명된 대로 EC2 Instance Connect를 사용하세요.
    

  

> **4) 연결이 거부되었습니다.**

이는 인스턴스에 연결할 수 있지만 인스턴스에서 실행 중인 SSH 유틸리티가 없음을 의미합니다.

- 인스턴스 다시 시작 시도
    
- 작동하지 않으면 인스턴스를 종료하고 **아마존 리눅스 2**를 사용하여 새 인스턴스를 만드십시오.
    

  

> **5)**  `Permission denied (publickey,gssapi-keyex,gssapi-with-mic)`

이것은 다음 두 가지를 의미합니다.

- 잘못된 보안 키를 사용하거나 보안 키를 사용하지 않고 있습니다. EC2 인스턴스 구성을 살펴보고 올바른 키를 할당했는지 확인하십시오.
    
- 잘못된 사용자를 사용하고 있습니다. **Amazon Linux 2 EC2 인스턴스**를 시작했는지 확인하고, **ec2 사용자**를 사용하고 있는지 확인하세요**.** 이것은 SSH 명령 또는 Putty 구성에서 **ec2-user@**`<public-ip>` (ex: `ec2-user@35.180.242.162`) 를 실행할 때 지정하는 것입니다.
    



> **6) 어제는 접속이 가능했는데 오늘은 안 되네요.**

이는 EC2 인스턴스를 중지했다가 오늘 다시 시작했기 때문일 수 있습니다. **그렇게 하면 EC2 인스턴스의 퍼블릭 IP가 변경됩니다.** 따라서 명령 또는 Putty 구성에서 새 공용 IP를 편집하고 저장해야 합니다.

---

## 9. EC2 인스턴스 연결 (EC2 Instance Connect) 
---
#### 1. **EC2 Instance Connect란?**

- EC2 Instance Connect는 **브라우저 기반**으로 EC2 인스턴스에 SSH 세션을 연결하는 기능.
- SSH 키를 따로 관리할 필요 없이 AWS에서 **임시 SSH 키**를 생성해 자동으로 연결.

---

#### 2. **EC2 Instance Connect 사용 방법**

1. **EC2 인스턴스 선택**:
    - EC2 콘솔에서 **My First Instance** 선택.
    - 상단의 **Connect** 버튼 클릭.
2. **Instance Connect 선택**:
    - 여러 옵션 중 **EC2 Instance Connect**를 선택.
3. **설정 확인**:
    - **공용 IP** 확인.
    - **사용자 이름**: 기본값 `ec2-user`로 설정. Amazon Linux 2에서 자동 설정됨.
    - SSH 키 옵션이 필요 없음.
4. **연결 실행**:
    - **Connect** 클릭 → 새 탭이 열리며 자동으로 EC2 인스턴스 연결.
    - 브라우저에서 명령 실행 가능:
        - 예: `whoami` → 결과: `ec2-user`
        - 예: `ping google.com`

---

#### 3. **EC2 Instance Connect의 장점**

- **사용자 친화적**: 터미널이나 명령줄 인터페이스를 사용할 필요 없음.
- **간편한 SSH 관리**: SSH 키를 따로 생성하거나 관리할 필요 없음.
- **빠른 연결**: 몇 번의 클릭만으로 인스턴스에 바로 접근 가능.
- **호환성**: Windows, Linux, Mac 모든 환경에서 사용 가능.

---

#### 4. **보안 그룹 문제 해결**

1. **SSH 인바운드 규칙 삭제 시 문제**:
    - SSH(22번 포트) 규칙이 삭제되면 Instance Connect 작동 불가.
    - "인스턴스 연결에 문제가 발생" 메시지 표시.
2. **규칙 복구 방법**:
    - **보안 그룹**에서 인바운드 규칙 수정.
    - SSH(22번 포트)를 **모든 위치(0.0.0.0/0)** 또는 **IPv6(모든 위치)**로 추가.
    - 규칙 저장 후 다시 Connect 시도.
3. **IPv6 문제 해결**:
    - IPv6 연결 환경에서는 IPv6 인바운드 규칙 추가 필요.

---

#### 5. **주의사항**

- **보안 규칙 확인**:
    - Instance Connect를 사용할 때 보안 그룹의 SSH(22번 포트) 규칙이 반드시 설정되어야 함.
- **IPv6 환경 지원**:
    - IPv6 사용 시 IPv6 인바운드 규칙 추가 필요.
- **연결 실패 시 확인 사항**:
    - 보안 그룹 설정.
    - 퍼블릭 IP 주소 변경 여부.

---


## 10. EC2 인스턴스 역할 (Role) 부여
---
### EC2 인스턴스를 위한 IAM 역할 사용 요약

#### 1. **IAM 역할의 필요성**

- EC2 인스턴스에서 AWS 리소스에 안전하게 접근하려면 IAM 역할 사용 필수.
- **IAM 역할의 장점**:
    - AWS 자격 증명(액세스 키 ID, 비밀 액세스 키)을 EC2 인스턴스에 직접 입력하지 않아도 됨.
    - 보안 강화: 자격 증명을 노출하지 않음.

---

#### 2. **IAM 역할 생성 및 연결**

1. **IAM 역할 생성**:
    - AWS 관리 콘솔 → IAM → **Roles** 메뉴에서 역할 생성.
    - 예: `DemoRoleForEC2` 역할 생성, `IAMReadOnlyAccess` 정책 연결.
2. **IAM 역할 연결**:
    - EC2 콘솔 → **Instances** → 인스턴스 선택.
    - **Actions → Security → Modify IAM role** 선택.
    - `DemoRoleForEC2` 역할 선택 후 저장.

---

#### 3. **IAM 역할 연결 상태 확인**

- **Security 탭**에서 연결된 IAM 역할 확인 가능.
    - 연결된 역할 예: `DemoRoleForEC2`.

---

#### 4. **IAM 역할로 AWS CLI 사용**

1. **AWS CLI 명령 실행**:
    - 예: `aws iam list-users`.
    - IAM 역할이 없으면 "자격 증명이 필요하다"는 메시지가 출력.
2. **IAM 역할 연결 후**:
    - IAM 역할 연결 시, `aws configure` 명령 없이도 AWS CLI 명령 실행 가능.
    - 예: `aws iam list-users` → 유저 목록 출력.

---

#### 5. **IAM 역할 권한 제거 및 검증**

1. **권한 제거**:
    - IAM 콘솔 → 역할 메뉴 → 연결된 정책 제거.
    - 다시 AWS CLI 명령 실행 시, "접근 거부" 메시지 출력.
2. **권한 재연결**:
    - 역할에 정책 다시 연결 (`IAMReadOnlyAccess`).
    - 정책 변경 사항은 전파에 시간이 걸릴 수 있음.
    - 재실행 후 정상 동작 확인.

---

#### 6. **IAM 역할 사용의 핵심**

- **AWS 자격 증명을 EC2 인스턴스에 직접 입력하지 말 것**:
    - `aws configure`로 키 입력 시 보안 위험 발생.
- **IAM 역할로 안전하게 자격 증명 제공**:
    - 역할 연결로 인스턴스에서 AWS 리소스 접근 가능.

---

#### 7. **주의사항**

1. **권한 전파 지연**:
    - IAM에서 변경된 내용이 AWS로 반영되기까지 시간이 소요될 수 있음.
2. **역할 연결 상태 확인**:
    - `Security` 탭에서 연결된 IAM 역할 확인 필수.
3. **권한 관리**:
    - 최소 권한 원칙에 따라 필요한 정책만 연결.

---

#### 8. **결론**

- IAM 역할은 EC2 인스턴스와 AWS 리소스 간의 안전한 연결을 보장.
- EC2 인스턴스에서 AWS CLI 명령 사용 시 IAM 역할 필수.
- 자격 증명을 EC2 인스턴스에 직접 입력하지 말고 항상 IAM 역할 사용.

---

## 11. EC2 인스턴스 구매 옵션
---
### EC2 인스턴스 구매 옵션 요약 노트

#### 1. **구매 옵션 개요**

- EC2는 다양한 워크로드에 맞는 구매 옵션을 제공.
- **온디맨드**, **예약 인스턴스**, **Savings Plans**, **스팟 인스턴스**, **전용 호스트**, **전용 인스턴스**, **용량 예약** 등.

---

#### 2. **구매 옵션별 상세 내용**

##### 2.1 **온디맨드 (On-Demand)**

- **특징**: 사용한 만큼 비용을 초당 또는 시간당 지불.
- **장점**: 선결제 없음, 장기 약정 불필요.
- **적합한 워크로드**:
    - 애플리케이션이 예측 불가능하거나 변동성이 큰 경우.
    - 단기 워크로드.
- **단점**: 가장 비싼 가격.

##### 2.2 **예약 인스턴스 (Reserved Instances)**

- **특징**: 특정 인스턴스를 1년 또는 3년 기간으로 예약.
- **할인율**: 최대 72% 할인 가능.
- **결제 옵션**:
    - 전체 선결제, 부분 선결제, 선결제 없음 (선결제 많을수록 할인율 증가).
- **적합한 워크로드**:
    - 안정적이고 예측 가능한 장기 워크로드 (예: 데이터베이스).
- **특수 유형**:
    - **전환형 예약 인스턴스**: 인스턴스 유형, OS 등을 변경 가능 (최대 66% 할인).

##### 2.3 **Savings Plans**

- **특징**: 1년 또는 3년 동안 시간당 일정 비용 약정.
- **할인율**: 최대 70% 할인.
- **유연성**:
    - 인스턴스 유형, 크기, 리전, OS, 테넌시 간 전환 가능.
- **적합한 워크로드**:
    - 장기적이고 유연성이 필요한 워크로드.

##### 2.4 **스팟 인스턴스 (Spot Instances)**

- **특징**: AWS의 남는 용량을 활용해 최대 90% 할인된 가격 제공.
- **단점**: 스팟 가격이 높아지면 인스턴스가 예고 없이 중단될 수 있음.
- **적합한 워크로드**:
    - 배치 작업, 데이터 분석, 이미지 처리, 유동적 워크로드.
- **부적합한 워크로드**:
    - 중요한 작업, 데이터베이스, 고가용성이 필요한 서비스.

##### 2.5 **전용 호스트 (Dedicated Host)**

- **특징**: 물리적 서버를 예약하여 사용.
- **비용**: 가장 비싼 옵션.
- **적합한 워크로드**:
    - 규정 준수 요구사항 (예: 금융, 의료).
    - 사용자 소프트웨어 라이선스 사용.

##### 2.6 **전용 인스턴스 (Dedicated Instance)**

- **특징**: 사용자 전용 하드웨어에서 실행.
- **전용 호스트와의 차이**:
    - 하드웨어 제어 권한 없음.
    - 같은 계정 내 다른 인스턴스와 하드웨어 공유 가능.

##### 2.7 **용량 예약 (Capacity Reservations)**

- **특징**: 특정 AZ에 온디맨드 인스턴스의 용량을 예약.
- **결제**: 인스턴스를 실행하지 않아도 요금 청구.
- **적합한 워크로드**:
    - 특정 AZ에서 용량을 미리 확보해야 하는 단기 워크로드.

---

#### 3. **옵션 비교**

|구매 옵션|할인율|결제 방식|적합한 워크로드|
|---|---|---|---|
|**온디맨드**|없음|초당/시간당 요금|예측 불가능하거나 단기 워크로드|
|**예약 인스턴스**|최대 72%|선결제 옵션 있음|장기적이고 예측 가능한 워크로드|
|**Savings Plans**|최대 70%|시간당 비용 약정|장기적이고 유연성이 필요한 워크로드|
|**스팟 인스턴스**|최대 90%|변동 가격|단기, 중단 가능 워크로드|
|**전용 호스트**|최대 70%|선결제/온디맨드|규정 준수, 소프트웨어 라이선스 사용|
|**전용 인스턴스**|없음|온디맨드|하드웨어 공유 없는 인스턴스|
|**용량 예약**|없음|온디맨드|특정 AZ에서 용량 확보|

---

#### 4. **리조트 비유**

- **온디맨드**: 호텔을 필요할 때마다 예약하고 정가 지불.
- **예약 인스턴스**: 1~3년 동안 장기 예약, 할인받음.
- **Savings Plans**: 매달 일정 금액을 약정, 방 종류는 유연하게 변경 가능.
- **스팟 인스턴스**: 빈 객실의 입찰 시스템, 저렴하지만 쫓겨날 수 있음.
- **전용 호스트**: 호텔 건물 전체 예약.
- **용량 예약**: 방을 예약하되 사용 여부와 관계없이 요금 지불.

---

#### 5. **시험에 나올 주요 포인트**

- 구매 옵션별 특징과 적합한 워크로드 이해.
- 할인율과 결제 방식 비교.
- 스팟 인스턴스의 중단 가능성 주의.
- 전용 호스트와 전용 인스턴스의 차이점 이해.

---

## 12. EC2 공동 책임 모델
---
### 공동 책임 모델 및 EC2 적용 방법 요약

#### 1. **공동 책임 모델 개요**

- **AWS와 사용자 간의 보안 책임을 분리**.
- **AWS의 책임**: 클라우드 내 **인프라 보안**.
- **사용자의 책임**: 클라우드 내 **데이터 및 리소스 보안**.

---

#### 2. **AWS의 책임 (클라우드 보안)**

- **데이터 센터 및 하드웨어**:
    - 물리적 데이터 센터 보안 유지.
    - 서버 장애 시 하드웨어 교체.
- **인프라 관리**:
    - 물리적 호스트와 사용자를 분리.
    - 서비스 규정 및 표준 준수 (예: SOC, ISO, PCI).
- **전용 호스트 및 하드웨어 관리**:
    - 전용 호스트 및 인스턴스 분리.
    - 규제 준수 요건 충족 보장.

---

#### 3. **사용자의 책임 (클라우드 내 보안)**

- **네트워크 보안**:
    - **보안 그룹** 규칙 정의:
        - EC2 인스턴스에 대한 인바운드 및 아웃바운드 트래픽 제어.
        - 인스턴스 접근 권한 설정.
- **운영체제 및 소프트웨어**:
    - EC2 인스턴스 내 **운영체제 관리**:
        - Linux, Windows 등 OS 패치 및 업데이트.
    - 애플리케이션, 소프트웨어, 유틸리티 설치 및 유지보수.
- **IAM 관리**:
    - **IAM 역할 및 정책 정의**:
        - 적절한 권한 설정.
        - IAM 역할을 사용해 자격 증명 보안 강화.
- **데이터 보안**:
    - 인스턴스 내 데이터 암호화 및 보호.
    - 백업 및 복구 계획 수립.

---

#### 4. **EC2에 적용되는 공동 책임 모델**

- AWS는 **EC2 인프라의 물리적 및 가상화된 환경**을 관리.
- 사용자는:
    - EC2 인스턴스 내부의 OS와 애플리케이션 관리.
    - 네트워크 설정 및 접근 제어.
    - 인스턴스 내 데이터 보호 및 IAM 정책 관리.

---

#### 5. **중요 포인트**

- **AWS는 인프라 제공자**:
    - 데이터 센터, 서버, 네트워크 관리.
- **사용자는 클라우드 내 보안 책임자**:
    - 인스턴스 운영체제, 네트워크 및 데이터 관리.
- **EC2 보안 체크리스트**:
    - 보안 그룹 및 IAM 정책 검토.
    - 운영체제와 소프트웨어 최신 상태 유지.
    - 데이터 암호화 및 백업 전략 수립.

---

#### 6. **결론**

- 공동 책임 모델은 AWS와 사용자 간 명확한 역할 분담을 정의.
- EC2 사용 시 보안 그룹, OS 관리, IAM 설정, 데이터 보호 등 **사용자 책임**이 중요.
- AWS는 안전한 인프라를 제공하며, 사용자는 이를 기반으로 **안전한 환경을 구축**해야 함.

---
